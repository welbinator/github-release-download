document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll(".wordpress-repo-button").forEach((t=>{t.addEventListener("click",(async function(){const e=t.getAttribute("data-slug"),o=t.getAttribute("data-type");if(!e||!o)return alert("Missing WordPress.org plugin/theme information.");t.textContent="Fetching...";try{const t=await fetch(`/wp-admin/admin-ajax.php?action=get_wordpress_repo_data&slug=${encodeURIComponent(e)}&type=${encodeURIComponent(o)}`),n=await t.json();n.success&&n.data.download_url?window.location.href=n.data.download_url:alert(n.data?.message||"Download failed.")}catch(t){console.error(t),alert("Error fetching download.")}finally{t.textContent=t.getAttribute("data-original-text")||"Download from WordPress.org"}}))}))}));